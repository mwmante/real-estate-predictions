{
  "paragraphs": [
    {
      "text": "%spark.pyspark\n\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.functions import udf\n\nspark \u003d SparkSession.builder.appName(\"Python Spark SQL basic example\").config(\"spark.some.config.option\", \"some-value\").getOrCreate()\n\nfrom pyspark.sql.types import StructType, StructField, IntegerType,StringType,LongType,DoubleType",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1525585869511_-239468288",
      "id": "20180506-015109_565495620",
      "dateCreated": "May 6, 2018 1:51:09 AM",
      "dateStarted": "May 6, 2018 4:44:47 PM",
      "dateFinished": "May 6, 2018 4:44:47 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\necon_schema \u003d StructType([\n    StructField(\"UNEMPL\", DoubleType(), True),\n    StructField(\"TRVL_WORK\", DoubleType(), True),\n    StructField(\"HOUSE_INC\", DoubleType(), True),\n    StructField(\"CAP_INC\", DoubleType(), True),\n    StructField(\"NO_HEALTH_INS\", DoubleType(), True),\n    StructField(\"DIST_NUM\", IntegerType(), True),\n    StructField(\"DIST_NAME\", StringType(), True),\n])\n\necon_data \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/EconData/EconData_FY14.csv\",header\u003dTrue, schema\u003decon_schema)\n\necon_data \u003d econ_data.drop(\"DIST_NAME\")\n\necon_data.show(n\u003d10)\n\n#econ_data_curr.printSchema()",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------+---------+-------+-------------+--------+\n|UNEMPL|TRVL_WORK|HOUSE_INC|CAP_INC|NO_HEALTH_INS|DIST_NUM|\n+------+---------+---------+-------+-------------+--------+\n| 0.072|     32.9|  52413.0|31345.0|      19887.0|     301|\n| 0.094|     35.2|  76670.0|49353.0|      12753.0|     302|\n|  0.15|     40.7|  37234.0|20766.0|      16924.0|     303|\n| 0.142|     39.5|  39262.0|18013.0|      34301.0|     304|\n| 0.123|     43.8|  34152.0|16238.0|      17912.0|     305|\n| 0.068|     37.5|  96138.0|59591.0|      10429.0|     306|\n| 0.099|     43.3|  44320.0|20528.0|      29951.0|     307|\n| 0.114|     41.4|  42127.0|26430.0|      18051.0|     308|\n| 0.156|     42.6|  41879.0|21531.0|      15977.0|     309|\n| 0.088|     42.6|  56454.0|31147.0|      13565.0|     310|\n+------+---------+---------+-------+-------------+--------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525585888990_-674372462",
      "id": "20180506-015128_1431338568",
      "dateCreated": "May 6, 2018 1:51:28 AM",
      "dateStarted": "May 6, 2018 4:44:47 PM",
      "dateFinished": "May 6, 2018 4:44:54 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\necon_next_schema \u003d StructType([\n    StructField(\"UNEMPL_next\", DoubleType(), True),\n    StructField(\"TRVL_WORK_next\", DoubleType(), True),\n    StructField(\"HOUSE_INC_next\", DoubleType(), True),\n    StructField(\"CAP_INC_next\", DoubleType(), True),\n    StructField(\"NO_HEALTH_INS_next\", DoubleType(), True),\n    StructField(\"DIST_NUM\", IntegerType(), True),\n    StructField(\"DIST_NAME_next\", StringType(), True),\n])\n\necon_data_next \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/EconData/EconData_FY16.csv\", header\u003dTrue, schema\u003decon_next_schema)\n\necon_data_next \u003d econ_data_next.drop(\"DIST_NAME_next\")\n\necon_data_next.show(n\u003d10)\n\necon_data_next.printSchema()",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------+--------------+--------------+------------+------------------+--------+\n|UNEMPL_next|TRVL_WORK_next|HOUSE_INC_next|CAP_INC_next|NO_HEALTH_INS_next|DIST_NUM|\n+-----------+--------------+--------------+------------+------------------+--------+\n|      0.062|          33.7|       59577.0|     35314.0|           15394.0|     301|\n|      0.079|          35.1|       82127.0|     53360.0|           10330.0|     302|\n|      0.128|          41.3|       40537.0|     23146.0|           13737.0|     303|\n|      0.127|          40.4|       42197.0|     20933.0|           28330.0|     304|\n|      0.101|          45.8|       36385.0|     17840.0|           14644.0|     305|\n|      0.059|          37.6|      104652.0|     65367.0|            6914.0|     306|\n|      0.077|          42.5|       48232.0|     22382.0|           25617.0|     307|\n|      0.086|          41.7|       45503.0|     29534.0|           15197.0|     308|\n|      0.112|          42.2|       44329.0|     24075.0|           13178.0|     309|\n|      0.078|          43.5|       60863.0|     32918.0|           11413.0|     310|\n+-----------+--------------+--------------+------------+------------------+--------+\nonly showing top 10 rows\n\nroot\n |-- UNEMPL_next: double (nullable \u003d true)\n |-- TRVL_WORK_next: double (nullable \u003d true)\n |-- HOUSE_INC_next: double (nullable \u003d true)\n |-- CAP_INC_next: double (nullable \u003d true)\n |-- NO_HEALTH_INS_next: double (nullable \u003d true)\n |-- DIST_NUM: integer (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525585919860_863114791",
      "id": "20180506-015159_496795387",
      "dateCreated": "May 6, 2018 1:51:59 AM",
      "dateStarted": "May 6, 2018 4:44:47 PM",
      "dateFinished": "May 6, 2018 4:44:54 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndef econ_change(attr1, attr2):\n    change \u003d  attr2 - attr1\n    return change / attr1 * 100\n\necon_udf \u003d udf(econ_change, DoubleType())\n\njoined_econ \u003d econ_data.join(econ_data_next, \"DIST_NUM\")\n\njoined_econ \u003d joined_econ.withColumn(\"UNEMPL_change\", econ_udf(joined_econ[\u0027UNEMPL\u0027], joined_econ[\u0027UNEMPL_next\u0027])) \n\njoined_econ \u003d joined_econ.withColumn(\"TRVL_change\", econ_udf(joined_econ[\u0027TRVL_WORK\u0027], joined_econ[\u0027TRVL_WORK_next\u0027])) \n\njoined_econ \u003d joined_econ.withColumn(\"HINC_change\", econ_udf(joined_econ[\u0027HOUSE_INC\u0027], joined_econ[\u0027HOUSE_INC_next\u0027])) \n\njoined_econ \u003d joined_econ.withColumn(\"CINC_change\", econ_udf(joined_econ[\u0027CAP_INC\u0027], joined_econ[\u0027CAP_INC_next\u0027])) \n\njoined_econ \u003d joined_econ.withColumn(\"HINS_change\", econ_udf(joined_econ[\u0027NO_HEALTH_INS\u0027], joined_econ[\u0027NO_HEALTH_INS_next\u0027])) \n\njoined_econ.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+------+---------+---------+-------+-------------+-----------+--------------+--------------+------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+\n|DIST_NUM|UNEMPL|TRVL_WORK|HOUSE_INC|CAP_INC|NO_HEALTH_INS|UNEMPL_next|TRVL_WORK_next|HOUSE_INC_next|CAP_INC_next|NO_HEALTH_INS_next|      UNEMPL_change|        TRVL_change|       HINC_change|       CINC_change|        HINS_change|\n+--------+------+---------+---------+-------+-------------+-----------+--------------+--------------+------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+\n|     301| 0.072|     32.9|  52413.0|31345.0|      19887.0|      0.062|          33.7|       59577.0|     35314.0|           15394.0|-13.888888888888884| 2.4316109422492533|13.668364718676665|12.662306587972564|-22.592648463820588|\n|     302| 0.094|     35.2|  76670.0|49353.0|      12753.0|      0.079|          35.1|       82127.0|     53360.0|           10330.0|-15.957446808510637|-0.2840909090909131| 7.117516629711752| 8.119060644742975|-18.999451109542854|\n|     303|  0.15|     40.7|  37234.0|20766.0|      16924.0|      0.128|          41.3|       40537.0|     23146.0|           13737.0| -14.66666666666666| 1.4742014742014602| 8.870924423913626|11.461042088028508| -18.83124556842354|\n|     304| 0.142|     39.5|  39262.0|18013.0|      34301.0|      0.127|          40.4|       42197.0|     20933.0|           28330.0|-10.563380281690131| 2.2784810126582244| 7.475421527176404| 16.21051462832399|-17.407655753476575|\n|     305| 0.123|     43.8|  34152.0|16238.0|      17912.0|      0.101|          45.8|       36385.0|     17840.0|           14644.0| -17.88617886178861|  4.566210045662101| 6.538416490981494| 9.865747013178963|-18.244752121482804|\n|     306| 0.068|     37.5|  96138.0|59591.0|      10429.0|      0.059|          37.6|      104652.0|     65367.0|            6914.0| -13.23529411764707| 0.2666666666666705| 8.856019472008986|  9.69273883640147| -33.70409435228689|\n|     307| 0.099|     43.3|  44320.0|20528.0|      29951.0|      0.077|          42.5|       48232.0|     22382.0|           25617.0|-22.222222222222225|-1.8475750577367143| 8.826714801444044| 9.031566640685892|-14.470301492437649|\n|     308| 0.114|     41.4|  42127.0|26430.0|      18051.0|      0.086|          41.7|       45503.0|     29534.0|           15197.0| -24.56140350877194| 0.7246376811594306| 8.013862843307143|11.744230041619371|-15.810758406736468|\n|     309| 0.156|     42.6|  41879.0|21531.0|      15977.0|      0.112|          42.2|       44329.0|     24075.0|           13178.0|-28.205128205128204|-0.9389671361502313| 5.850187444781394|11.815521805768427| -17.51893346685861|\n|     310| 0.088|     42.6|  56454.0|31147.0|      13565.0|      0.078|          43.5|       60863.0|     32918.0|           11413.0| -11.36363636363636| 2.1126760563380245|  7.80989832429943| 5.685940861078113|-15.864356800589752|\n+--------+------+---------+---------+-------+-------------+-----------+--------------+--------------+------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525585953093_-593282389",
      "id": "20180506-015233_1628281214",
      "dateCreated": "May 6, 2018 1:52:33 AM",
      "dateStarted": "May 6, 2018 4:44:54 PM",
      "dateFinished": "May 6, 2018 4:44:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\njoined_econ \u003d joined_econ.drop(\"UNEMPL\", \"UNEMPL_next\",\"TRVL_WORK\", \"TRVL_WORK_next\", \"HOUSE_INC\", \"HOUSE_INC_next\", \"CAP_INC\", \"CAP_INC_next\", \"NO_HEALTH_INS\", \"NO_HEALTH_INS_next\")\n\njoined_econ.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+-------------------+-------------------+------------------+------------------+-------------------+\n|DIST_NUM|      UNEMPL_change|        TRVL_change|       HINC_change|       CINC_change|        HINS_change|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+\n|     301|-13.888888888888884| 2.4316109422492533|13.668364718676665|12.662306587972564|-22.592648463820588|\n|     302|-15.957446808510637|-0.2840909090909131| 7.117516629711752| 8.119060644742975|-18.999451109542854|\n|     303| -14.66666666666666| 1.4742014742014602| 8.870924423913626|11.461042088028508| -18.83124556842354|\n|     304|-10.563380281690131| 2.2784810126582244| 7.475421527176404| 16.21051462832399|-17.407655753476575|\n|     305| -17.88617886178861|  4.566210045662101| 6.538416490981494| 9.865747013178963|-18.244752121482804|\n|     306| -13.23529411764707| 0.2666666666666705| 8.856019472008986|  9.69273883640147| -33.70409435228689|\n|     307|-22.222222222222225|-1.8475750577367143| 8.826714801444044| 9.031566640685892|-14.470301492437649|\n|     308| -24.56140350877194| 0.7246376811594306| 8.013862843307143|11.744230041619371|-15.810758406736468|\n|     309|-28.205128205128204|-0.9389671361502313| 5.850187444781394|11.815521805768427| -17.51893346685861|\n|     310| -11.36363636363636| 2.1126760563380245|  7.80989832429943| 5.685940861078113|-15.864356800589752|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525586434760_213594062",
      "id": "20180506-020034_801971714",
      "dateCreated": "May 6, 2018 2:00:34 AM",
      "dateStarted": "May 6, 2018 4:44:55 PM",
      "dateFinished": "May 6, 2018 4:44:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nsoc_schema \u003d StructType([\n    StructField(\"DIST_NAME\", StringType(), True),\n    StructField(\"DIST_NUM\", IntegerType(), True),\n    StructField(\"BORO\", StringType(), True),\n    StructField(\"HOUSEH_SZ\", DoubleType(), True),\n    StructField(\"BACH_DEG\", DoubleType(), True),\n    StructField(\"DIFF_HOUSE\", DoubleType(), True),\n    StructField(\"FORB\", DoubleType(), True),\n    StructField(\"NAT_CIT\", DoubleType(), True),\n    StructField(\"LANG\", DoubleType(), True),\n    StructField(\"AGE\", DoubleType(), True),\n])\n\nsoc_data \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/soc_data/2014_soc_data.csv\", header\u003dTrue, schema \u003d soc_schema)\n\nsoc_data \u003d soc_data.drop(\"DIST_NAME\", \"BORO\")\n\nsoc_data.show(n\u003d10)\n\nsoc_data.printSchema()",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+---------+--------+----------+-----+-------+-----+----+\n|DIST_NUM|HOUSEH_SZ|BACH_DEG|DIFF_HOUSE| FORB|NAT_CIT| LANG| AGE|\n+--------+---------+--------+----------+-----+-------+-----+----+\n|     208|     2.48|   0.376|     0.111|0.316|  0.556|0.532|null|\n|     212|     2.98|   0.218|     0.084|0.394|  0.595|0.269|null|\n|     210|     2.54|   0.249|     0.087|0.202|  0.649|0.382|null|\n|     211|     2.87|   0.238|     0.091| 0.35|  0.485|0.568|null|\n|    null|     null|    null|      null| null|   null| null|null|\n|     207|     2.85|   0.165|     0.113|0.419|  0.406|0.718|null|\n|     205|     2.98|   0.122|     0.117|0.414|  0.363|0.709|null|\n|     204|     2.92|   0.131|     0.084|0.402|  0.397|0.702|null|\n|     209|     2.93|   0.164|     0.089|0.319|   0.45| 0.57|null|\n|    null|     null|    null|      null| null|   null| null|null|\n+--------+---------+--------+----------+-----+-------+-----+----+\nonly showing top 10 rows\n\nroot\n |-- DIST_NUM: integer (nullable \u003d true)\n |-- HOUSEH_SZ: double (nullable \u003d true)\n |-- BACH_DEG: double (nullable \u003d true)\n |-- DIFF_HOUSE: double (nullable \u003d true)\n |-- FORB: double (nullable \u003d true)\n |-- NAT_CIT: double (nullable \u003d true)\n |-- LANG: double (nullable \u003d true)\n |-- AGE: double (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525585995223_489462312",
      "id": "20180506-015315_1335576703",
      "dateCreated": "May 6, 2018 1:53:15 AM",
      "dateStarted": "May 6, 2018 4:44:55 PM",
      "dateFinished": "May 6, 2018 4:44:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nsoc_schema_next \u003d StructType([\n    StructField(\"DIST_NAME\", StringType(), True),\n    StructField(\"DIST_NUM\", IntegerType(), True),\n    StructField(\"BORO\", StringType(), True),\n    StructField(\"HOUSEH_SZ_next\", DoubleType(), True),\n    StructField(\"BACH_DEG_next\", DoubleType(), True),\n    StructField(\"DIFF_HOUSE_next\", DoubleType(), True),\n    StructField(\"FORB_next\", DoubleType(), True),\n    StructField(\"NAT_CIT_next\", DoubleType(), True),\n    StructField(\"LANG_next\", DoubleType(), True),\n    StructField(\"AGE_next\", DoubleType(), True),\n])\n\nsoc_data_next \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/soc_data/2016_soc_data.csv\", header\u003dTrue, schema \u003d soc_schema_next)\n\nsoc_data_next \u003d soc_data_next.filter(soc_data_next.BORO \u003d\u003d \"Brooklyn\")\n\nsoc_data_next \u003d soc_data_next.drop(\"DIST_NAME\", \"BORO\")\n\nsoc_data_next.show(n\u003d10)\n\nsoc_data_next.printSchema()",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------+-------------+---------------+---------+------------+---------+--------+\n|DIST_NUM|HOUSEH_SZ_next|BACH_DEG_next|DIFF_HOUSE_next|FORB_next|NAT_CIT_next|LANG_next|AGE_next|\n+--------+--------------+-------------+---------------+---------+------------+---------+--------+\n|     301|          2.47|        0.463|          0.108|    0.236|       0.527|    0.528|    31.6|\n|     304|          2.94|        0.238|          0.127|    0.346|       0.356|    0.599|    30.4|\n|     303|          2.74|        0.296|          0.114|    0.196|       0.534|    0.319|    30.7|\n|     302|          2.21|        0.599|          0.153|    0.201|       0.514|    0.287|    34.6|\n|     306|          2.34|        0.709|          0.163|     0.17|       0.491|    0.256|    35.7|\n|     308|          2.38|        0.381|          0.106|    0.295|       0.571|    0.216|    34.2|\n|     316|          2.66|        0.132|          0.083|    0.302|       0.541|    0.243|    31.6|\n|     305|          2.89|        0.146|          0.065|    0.359|       0.567|    0.441|    33.1|\n|     318|          3.03|        0.304|          0.057|    0.405|        0.72|    0.304|    37.8|\n|     317|          2.78|        0.223|          0.055|    0.531|       0.635|    0.221|    37.8|\n+--------+--------------+-------------+---------------+---------+------------+---------+--------+\nonly showing top 10 rows\n\nroot\n |-- DIST_NUM: integer (nullable \u003d true)\n |-- HOUSEH_SZ_next: double (nullable \u003d true)\n |-- BACH_DEG_next: double (nullable \u003d true)\n |-- DIFF_HOUSE_next: double (nullable \u003d true)\n |-- FORB_next: double (nullable \u003d true)\n |-- NAT_CIT_next: double (nullable \u003d true)\n |-- LANG_next: double (nullable \u003d true)\n |-- AGE_next: double (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525586027183_-241313767",
      "id": "20180506-015347_1763587924",
      "dateCreated": "May 6, 2018 1:53:47 AM",
      "dateStarted": "May 6, 2018 4:44:56 PM",
      "dateFinished": "May 6, 2018 4:44:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndef soc_change(attr1, attr2):\n    change \u003d  attr2 - attr1\n    return change / attr1 * 100\n\nsoc_udf \u003d udf(soc_change, DoubleType())\n\njoined_soc \u003d soc_data.join(soc_data_next, \"DIST_NUM\")\n\njoined_soc \u003d joined_soc.withColumn(\"HH_change\", soc_udf(joined_soc[\u0027HOUSEH_SZ\u0027], joined_soc[\u0027HOUSEH_SZ_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"BACH_change\", soc_udf(joined_soc[\u0027BACH_DEG\u0027], joined_soc[\u0027BACH_DEG_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"DIFFH_change\", soc_udf(joined_soc[\u0027DIFF_HOUSE\u0027], joined_soc[\u0027DIFF_HOUSE_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"FORB_change\", soc_udf(joined_soc[\u0027FORB\u0027], joined_soc[\u0027FORB_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"NCIT_change\", soc_udf(joined_soc[\u0027NAT_CIT\u0027], joined_soc[\u0027NAT_CIT_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"LANG_change\", soc_udf(joined_soc[\u0027LANG\u0027], joined_soc[\u0027LANG_next\u0027])) \n\njoined_soc \u003d joined_soc.withColumn(\"AGE_change\", soc_udf(joined_soc[\u0027AGE\u0027], joined_soc[\u0027AGE_next\u0027])) \n\njoined_soc.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+---------+--------+----------+-----+-------+-----+----+--------------+-------------+---------------+---------+------------+---------+--------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|DIST_NUM|HOUSEH_SZ|BACH_DEG|DIFF_HOUSE| FORB|NAT_CIT| LANG| AGE|HOUSEH_SZ_next|BACH_DEG_next|DIFF_HOUSE_next|FORB_next|NAT_CIT_next|LANG_next|AGE_next|          HH_change|       BACH_change|      DIFFH_change|        FORB_change|        NCIT_change|        LANG_change|        AGE_change|\n+--------+---------+--------+----------+-----+-------+-----+----+--------------+-------------+---------------+---------+------------+---------+--------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|     301|     2.44|   0.437|     0.104|0.239|  0.514|0.551|31.5|          2.47|        0.463|          0.108|    0.236|       0.527|    0.528|    31.6| 1.2295081967213217| 5.949656750572087|  3.84615384615385|-1.2552301255230138|  2.529182879377434| -4.174228675136119| 0.317460317460322|\n|     304|     3.06|   0.198|     0.114| 0.36|  0.318|0.635|30.0|          2.94|        0.238|          0.127|    0.346|       0.356|    0.599|    30.4| -3.921568627450984| 20.20202020202019|11.403508771929822|-3.8888888888888924| 11.949685534591188| -5.669291338582682|1.3333333333333286|\n|     303|     2.74|   0.251|     0.109|0.199|  0.508|0.311|30.9|          2.74|        0.296|          0.114|    0.196|       0.534|    0.319|    30.7|                0.0|17.928286852589633| 4.587155963302757|-1.5075376884422125|  5.118110236220478|  2.572347266881031|-0.647249190938509|\n|     302|      2.2|   0.582|     0.144|0.197|  0.527|0.286|33.9|          2.21|        0.599|          0.153|    0.201|       0.514|    0.287|    34.6| 0.4545454545454448|2.9209621993127177| 6.250000000000005|   2.03045685279188|-2.4667931688804576|   0.34965034965035|  2.06489675516225|\n|     306|     2.32|   0.678|     0.152|0.173|  0.498|0.275|35.3|          2.34|        0.709|          0.163|     0.17|       0.491|    0.256|    35.7| 0.8620689655172422| 4.572271386430666|7.2368421052631655|-1.7341040462427602|-1.4056224899598406|-6.9090909090909145|1.1331444759206961|\n|     308|     2.38|   0.349|     0.097|0.312|  0.543|0.218|33.9|          2.38|        0.381|          0.106|    0.295|       0.571|    0.216|    34.2|                0.0| 9.169054441260755| 9.278350515463911| -5.448717948717953|   5.15653775322282|-0.9174311926605512|0.8849557522124021|\n|     316|     2.77|   0.111|     0.082|0.299|  0.516|0.229|30.4|          2.66|        0.132|          0.083|    0.302|       0.541|    0.243|    31.6|-3.9711191335740024|18.918918918918923|1.2195121951219523|  1.003344481605352|  4.844961240310082|  6.113537117903923| 3.947368421052641|\n|     305|     2.91|   0.134|     0.062|0.346|  0.562|0.425|32.3|          2.89|        0.146|          0.065|    0.359|       0.567|    0.441|    33.1|-0.6872852233676982| 8.955223880597002|4.8387096774193585|  3.757225433526015| 0.8896797153024721| 3.7647058823529442|2.4767801857585274|\n|     318|     3.02|   0.289|     0.052|0.412|  0.697|0.307|37.4|          3.03|        0.304|          0.057|    0.405|        0.72|    0.304|    37.8|0.33112582781456246| 5.190311418685126| 9.615384615384624|-1.6990291262135804|  3.299856527977048|-0.9771986970684049|1.0695187165775364|\n|     317|     2.78|   0.203|      0.06|0.526|  0.619|0.198|37.8|          2.78|        0.223|          0.055|    0.531|       0.635|    0.221|    37.8|                0.0| 9.852216748768468| -8.33333333333333|  0.950570342205324|  2.584814216478193| 11.616161616161612|               0.0|\n+--------+---------+--------+----------+-----+-------+-----+----+--------------+-------------+---------------+---------+------------+---------+--------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525586064194_1654005288",
      "id": "20180506-015424_1993932371",
      "dateCreated": "May 6, 2018 1:54:24 AM",
      "dateStarted": "May 6, 2018 4:44:56 PM",
      "dateFinished": "May 6, 2018 4:44:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\njoined_soc \u003d joined_soc.drop(\"HOUSH_SZ\", \"HOUSEH_SZ_next\", \"BACH_DEG\", \"BACH_DEG_next\", \"DIFF_HOUSE\", \"DIFF_HOUSE_next\", \"FORB\", \"FORB_next\", \"NAT_CIT\", \"NAT_CIT_next\", \"LANG\", \"LANG_next\", \"AGE\", \"AGE_next\")\n\njoined_soc.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|DIST_NUM|HOUSEH_SZ|          HH_change|       BACH_change|      DIFFH_change|        FORB_change|        NCIT_change|        LANG_change|        AGE_change|\n+--------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|     301|     2.44| 1.2295081967213217| 5.949656750572087|  3.84615384615385|-1.2552301255230138|  2.529182879377434| -4.174228675136119| 0.317460317460322|\n|     304|     3.06| -3.921568627450984| 20.20202020202019|11.403508771929822|-3.8888888888888924| 11.949685534591188| -5.669291338582682|1.3333333333333286|\n|     303|     2.74|                0.0|17.928286852589633| 4.587155963302757|-1.5075376884422125|  5.118110236220478|  2.572347266881031|-0.647249190938509|\n|     302|      2.2| 0.4545454545454448|2.9209621993127177| 6.250000000000005|   2.03045685279188|-2.4667931688804576|   0.34965034965035|  2.06489675516225|\n|     306|     2.32| 0.8620689655172422| 4.572271386430666|7.2368421052631655|-1.7341040462427602|-1.4056224899598406|-6.9090909090909145|1.1331444759206961|\n|     308|     2.38|                0.0| 9.169054441260755| 9.278350515463911| -5.448717948717953|   5.15653775322282|-0.9174311926605512|0.8849557522124021|\n|     316|     2.77|-3.9711191335740024|18.918918918918923|1.2195121951219523|  1.003344481605352|  4.844961240310082|  6.113537117903923| 3.947368421052641|\n|     305|     2.91|-0.6872852233676982| 8.955223880597002|4.8387096774193585|  3.757225433526015| 0.8896797153024721| 3.7647058823529442|2.4767801857585274|\n|     318|     3.02|0.33112582781456246| 5.190311418685126| 9.615384615384624|-1.6990291262135804|  3.299856527977048|-0.9771986970684049|1.0695187165775364|\n|     317|     2.78|                0.0| 9.852216748768468| -8.33333333333333|  0.950570342205324|  2.584814216478193| 11.616161616161612|               0.0|\n+--------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525587066895_-1512825683",
      "id": "20180506-021106_815351175",
      "dateCreated": "May 6, 2018 2:11:06 AM",
      "dateStarted": "May 6, 2018 4:44:56 PM",
      "dateFinished": "May 6, 2018 4:44:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY12_14_soc_econ_change \u003d joined_econ.join(joined_soc, \"DIST_NUM\")\n\nFY12_14_soc_econ_change.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|DIST_NUM|      UNEMPL_change|        TRVL_change|       HINC_change|       CINC_change|        HINS_change|HOUSEH_SZ|          HH_change|       BACH_change|      DIFFH_change|        FORB_change|        NCIT_change|        LANG_change|        AGE_change|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\n|     301|-13.888888888888884| 2.4316109422492533|13.668364718676665|12.662306587972564|-22.592648463820588|     2.44| 1.2295081967213217| 5.949656750572087|  3.84615384615385|-1.2552301255230138|  2.529182879377434| -4.174228675136119| 0.317460317460322|\n|     302|-15.957446808510637|-0.2840909090909131| 7.117516629711752| 8.119060644742975|-18.999451109542854|      2.2| 0.4545454545454448|2.9209621993127177| 6.250000000000005|   2.03045685279188|-2.4667931688804576|   0.34965034965035|  2.06489675516225|\n|     303| -14.66666666666666| 1.4742014742014602| 8.870924423913626|11.461042088028508| -18.83124556842354|     2.74|                0.0|17.928286852589633| 4.587155963302757|-1.5075376884422125|  5.118110236220478|  2.572347266881031|-0.647249190938509|\n|     304|-10.563380281690131| 2.2784810126582244| 7.475421527176404| 16.21051462832399|-17.407655753476575|     3.06| -3.921568627450984| 20.20202020202019|11.403508771929822|-3.8888888888888924| 11.949685534591188| -5.669291338582682|1.3333333333333286|\n|     305| -17.88617886178861|  4.566210045662101| 6.538416490981494| 9.865747013178963|-18.244752121482804|     2.91|-0.6872852233676982| 8.955223880597002|4.8387096774193585|  3.757225433526015| 0.8896797153024721| 3.7647058823529442|2.4767801857585274|\n|     306| -13.23529411764707| 0.2666666666666705| 8.856019472008986|  9.69273883640147| -33.70409435228689|     2.32| 0.8620689655172422| 4.572271386430666|7.2368421052631655|-1.7341040462427602|-1.4056224899598406|-6.9090909090909145|1.1331444759206961|\n|     307|-22.222222222222225|-1.8475750577367143| 8.826714801444044| 9.031566640685892|-14.470301492437649|      3.2| 1.5624999999999944| 6.504065040650413|               0.0|-0.6237006237006243|  5.539358600583079| -1.200000000000001|1.5243902439024393|\n|     308| -24.56140350877194| 0.7246376811594306| 8.013862843307143|11.744230041619371|-15.810758406736468|     2.38|                0.0| 9.169054441260755| 9.278350515463911| -5.448717948717953|   5.15653775322282|-0.9174311926605512|0.8849557522124021|\n|     309|-28.205128205128204|-0.9389671361502313| 5.850187444781394|11.815521805768427| -17.51893346685861|     2.67|-1.4981273408239715| 12.06225680933851|2.4390243902439046|  -1.90930787589499|  5.614035087719304|  6.228373702422151|0.5865102639296063|\n|     310| -11.36363636363636| 2.1126760563380245|  7.80989832429943| 5.685940861078113|-15.864356800589752|     2.61|-1.5325670498084305| 7.065217391304354| 16.86746987951807|  2.343750000000002| 0.6956521739130441|   1.80505415162453|1.8087855297157511|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525587439084_-2073901782",
      "id": "20180506-021719_3623004",
      "dateCreated": "May 6, 2018 2:17:19 AM",
      "dateStarted": "May 6, 2018 4:44:56 PM",
      "dateFinished": "May 6, 2018 4:44:57 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nfrom pyspark.sql.functions import lit\n\nFY12_14_soc_econ_change \u003d FY12_14_soc_econ_change.withColumn(\"MTG_RT_change\", lit(10.98))\n\nFY12_14_soc_econ_change.show(n \u003d 10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\n|DIST_NUM|      UNEMPL_change|        TRVL_change|       HINC_change|       CINC_change|        HINS_change|HOUSEH_SZ|          HH_change|       BACH_change|      DIFFH_change|        FORB_change|        NCIT_change|        LANG_change|        AGE_change|MTG_RT_change|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\n|     301|-13.888888888888884| 2.4316109422492533|13.668364718676665|12.662306587972564|-22.592648463820588|     2.44| 1.2295081967213217| 5.949656750572087|  3.84615384615385|-1.2552301255230138|  2.529182879377434| -4.174228675136119| 0.317460317460322|        10.98|\n|     302|-15.957446808510637|-0.2840909090909131| 7.117516629711752| 8.119060644742975|-18.999451109542854|      2.2| 0.4545454545454448|2.9209621993127177| 6.250000000000005|   2.03045685279188|-2.4667931688804576|   0.34965034965035|  2.06489675516225|        10.98|\n|     303| -14.66666666666666| 1.4742014742014602| 8.870924423913626|11.461042088028508| -18.83124556842354|     2.74|                0.0|17.928286852589633| 4.587155963302757|-1.5075376884422125|  5.118110236220478|  2.572347266881031|-0.647249190938509|        10.98|\n|     304|-10.563380281690131| 2.2784810126582244| 7.475421527176404| 16.21051462832399|-17.407655753476575|     3.06| -3.921568627450984| 20.20202020202019|11.403508771929822|-3.8888888888888924| 11.949685534591188| -5.669291338582682|1.3333333333333286|        10.98|\n|     305| -17.88617886178861|  4.566210045662101| 6.538416490981494| 9.865747013178963|-18.244752121482804|     2.91|-0.6872852233676982| 8.955223880597002|4.8387096774193585|  3.757225433526015| 0.8896797153024721| 3.7647058823529442|2.4767801857585274|        10.98|\n|     306| -13.23529411764707| 0.2666666666666705| 8.856019472008986|  9.69273883640147| -33.70409435228689|     2.32| 0.8620689655172422| 4.572271386430666|7.2368421052631655|-1.7341040462427602|-1.4056224899598406|-6.9090909090909145|1.1331444759206961|        10.98|\n|     307|-22.222222222222225|-1.8475750577367143| 8.826714801444044| 9.031566640685892|-14.470301492437649|      3.2| 1.5624999999999944| 6.504065040650413|               0.0|-0.6237006237006243|  5.539358600583079| -1.200000000000001|1.5243902439024393|        10.98|\n|     308| -24.56140350877194| 0.7246376811594306| 8.013862843307143|11.744230041619371|-15.810758406736468|     2.38|                0.0| 9.169054441260755| 9.278350515463911| -5.448717948717953|   5.15653775322282|-0.9174311926605512|0.8849557522124021|        10.98|\n|     309|-28.205128205128204|-0.9389671361502313| 5.850187444781394|11.815521805768427| -17.51893346685861|     2.67|-1.4981273408239715| 12.06225680933851|2.4390243902439046|  -1.90930787589499|  5.614035087719304|  6.228373702422151|0.5865102639296063|        10.98|\n|     310| -11.36363636363636| 2.1126760563380245|  7.80989832429943| 5.685940861078113|-15.864356800589752|     2.61|-1.5325670498084305| 7.065217391304354| 16.86746987951807|  2.343750000000002| 0.6956521739130441|   1.80505415162453|1.8087855297157511|        10.98|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525635547573_-1051135667",
      "id": "20180506-153907_724369230",
      "dateCreated": "May 6, 2018 3:39:07 PM",
      "dateStarted": "May 6, 2018 4:44:57 PM",
      "dateFinished": "May 6, 2018 4:44:57 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY12_14_soc_econ_change.write.format(\"csv\").option(\"header\", \"true\").save(\"/user/nycDevPlan_PBD18/data/FY18_20_soc_econ_change.csv\")",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1525587525492_-113466574",
      "id": "20180506-021845_871230563",
      "dateCreated": "May 6, 2018 2:18:45 AM",
      "dateStarted": "May 6, 2018 4:44:57 PM",
      "dateFinished": "May 6, 2018 4:44:58 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 4:44:47 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1525587629636_-128117680",
      "id": "20180506-022029_1624494721",
      "dateCreated": "May 6, 2018 2:20:29 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "soc_econ_change",
  "id": "2DDD4QVJC",
  "angularObjects": {
    "2CFXK5J4Y:shared_process": [],
    "2CF295UYG:shared_process": [],
    "2CD6ZRPDJ:shared_process": [],
    "2CFG6Y8G3:shared_process": [],
    "2CFJKQVBN:shared_process": [],
    "2CGYXR37V:shared_process": [],
    "2CDY97F39:shared_process": [],
    "2CEC5KMFB:shared_process": [],
    "2CFFWS5P3:shared_process": [],
    "2CDM4T1EH:shared_process": [],
    "2CG949ZHZ:shared_process": [],
    "2CEJ86HV3:shared_process": [],
    "2CFGNABPQ:shared_process": [],
    "2CEZV3CHG:shared_process": [],
    "2CDUTWP3P:shared_process": [],
    "2CFXDXWCE:shared_process": [],
    "2CEZMWG72:shared_process": [],
    "2CFWFHNZR:shared_process": [],
    "2CG23YGEZ:shared_process": []
  },
  "config": {},
  "info": {}
}