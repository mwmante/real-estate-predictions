{
  "paragraphs": [
    {
      "text": "%spark.pyspark\n\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.functions import udf\n\nspark \u003d SparkSession.builder.appName(\"Python Spark SQL basic example\").config(\"spark.some.config.option\", \"some-value\").getOrCreate()\n\nfrom pyspark.sql.types import StructType, StructField, IntegerType,StringType,LongType,DoubleType\n\ninput_schema \u003d StructType([\n    StructField(\"BBLE\", StringType(), True),\n    StructField(\"B\", IntegerType(), True),\n    StructField(\"BLOCK\", LongType(), True),\n    StructField(\"LOT\", LongType(), True),\n    StructField(\"EASEMENT\", StringType(), True),\n    StructField(\"OWNER\", StringType(), True),\n    StructField(\"BLDGCL\", StringType(), True),\n    StructField(\"TAXCLASS\", StringType(), True),\n    StructField(\"LTFRONT\", StringType(), True),\n    StructField(\"LTDEP\", StringType(), True),\n    StructField(\"EXT\", StringType(), True),\n    StructField(\"STORIES\", StringType(), True),\n    StructField(\"FULLVAL\", DoubleType(), True),\n    StructField(\"AVLAND\", DoubleType(), True),\n    StructField(\"AVTOT\", DoubleType(), True),\n    StructField(\"EXLAND\", DoubleType(), True),\n    StructField(\"EXTOT\", DoubleType(), True),\n    StructField(\"EXCD1\", StringType(), True),\n    StructField(\"STADDR\", StringType(), True),\n    StructField(\"ZIP\", StringType(), True),\n    StructField(\"EXMPTCL\", StringType(), True),\n    StructField(\"BLDFRONT\", StringType(), True),\n    StructField(\"BLDDEPTH\", StringType(), True),\n    StructField(\"AVLAND2\", DoubleType(), True),\n    StructField(\"AVTOT2\", DoubleType(), True),\n    StructField(\"EXLAND2\", DoubleType(), True),\n    StructField(\"EXTOT2\", DoubleType(), True),\n    StructField(\"EXCD2\", StringType(), True),\n    StructField(\"PERIOD\", StringType(), True),\n    StructField(\"YEAR\", StringType(), True)\n])\n",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1525557206043_-598313955",
      "id": "20180505-175326_2021001567",
      "dateCreated": "May 5, 2018 5:53:26 PM",
      "dateStarted": "May 6, 2018 6:47:59 PM",
      "dateFinished": "May 6, 2018 6:47:59 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndistrict_data \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/district_mapping_dataset.csv\",header\u003dTrue)\n\ndistrict_data \u003d district_data.selectExpr(\u0027borough_tax_block_lot_bbl as BBLE\u0027, \u0027community_district\u0027, \u0027community_district_definition\u0027)\n\ndistrict_data.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+------------------+-----------------------------+\n|      BBLE|community_district|community_district_definition|\n+----------+------------------+-----------------------------+\n|5052990075|               503|         Tottenville, Grea...|\n|5052990076|               503|         Tottenville, Grea...|\n|5052990077|               503|         Tottenville, Grea...|\n|5052990078|               503|         Tottenville, Grea...|\n|5052990079|               503|         Tottenville, Grea...|\n|5052990080|               503|         Tottenville, Grea...|\n|5052990081|               503|         Tottenville, Grea...|\n|5052990082|               503|         Tottenville, Grea...|\n|5052990083|               503|         Tottenville, Grea...|\n|5052990084|               503|         Tottenville, Grea...|\n+----------+------------------+-----------------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525573067467_539919055",
      "id": "20180505-221747_1152690212",
      "dateCreated": "May 5, 2018 10:17:47 PM",
      "dateStarted": "May 6, 2018 6:47:59 PM",
      "dateFinished": "May 6, 2018 6:48:04 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\n\nFY_curr \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/Property_Tax_Valuations/avroll_FY17.txt\",header\u003dFalse,schema\u003dinput_schema)\n\nFY_curr \u003d FY_curr.selectExpr(\u0027BBLE\u0027,\u0027B\u0027,\u0027BLOCK\u0027,\u0027LOT\u0027,\u0027FULLVAL AS FULLVAL_CURR\u0027,\u0027OWNER\u0027,\u0027BLDGCL\u0027,\u0027TAXCLASS\u0027,\u0027STORIES\u0027,\u0027STADDR\u0027,\u0027ZIP\u0027,\u0027EXMPTCL\u0027)\n\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"Z%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"Y%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"E%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"F%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"G%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"I%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"J%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"M%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"N%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"P%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"Q%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"T%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"U%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"W%\" ) ) )\n\nFY_curr \u003d FY_curr.filter(FY_curr.FULLVAL_CURR !\u003d 0.0)\n\nFY_curr \u003d FY_curr.filter(FY_curr.B \u003d\u003d 3)\n\nFY_curr.show(n\u003d10)\n",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+----+------------+--------------------+------+--------+-------+-------------+-----+-------+\n|      BBLE|  B|BLOCK| LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|       STADDR|  ZIP|EXMPTCL|\n+----------+---+-----+----+------------+--------------------+------+--------+-------+-------------+-----+-------+\n|3000010001|  3|    1|   1|   2588100.0|BROOKLYN BRIDGE PARK|    V1|       4|   null|  JOHN STREET|11201|   null|\n|3000011001|  3|    1|1001|    346682.0|                null|    RK|       4|     12|1 JOHN STREET|11201|   null|\n|3000011002|  3|    1|1002|    226776.0|                null|    RK|       4|     12|1 JOHN STREET|11201|   null|\n|3000011003|  3|    1|1003|    318004.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011004|  3|    1|1004|    306278.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011005|  3|    1|1005|    181156.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011006|  3|    1|1006|    293242.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011007|  3|    1|1007|    318004.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011008|  3|    1|1008|    306278.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n|3000011009|  3|    1|1009|    181156.0|                null|    R4|       2|     12|1 JOHN STREET|11201|   null|\n+----------+---+-----+----+------------+--------------------+------+--------+-------+-------------+-----+-------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525567387708_135710775",
      "id": "20180505-204307_186521091",
      "dateCreated": "May 5, 2018 8:43:07 PM",
      "dateStarted": "May 6, 2018 6:48:00 PM",
      "dateFinished": "May 6, 2018 6:48:07 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY_curr \u003d FY_curr.join(district_data, \"BBLE\", how\u003d\u0027inner\u0027)\n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|community_district_definition|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|         Brooklyn Heights ...|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|         Brooklyn Heights ...|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|         Brooklyn Heights ...|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|         Brooklyn Heights ...|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|         Brooklyn Heights ...|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|         Brooklyn Heights ...|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|         Brooklyn Heights ...|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525574169845_-62246388",
      "id": "20180505-223609_520061577",
      "dateCreated": "May 5, 2018 10:36:09 PM",
      "dateStarted": "May 6, 2018 6:48:05 PM",
      "dateFinished": "May 6, 2018 6:48:17 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nFY_next \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/Property_Tax_Valuations/avroll_FY19.txt\",header\u003dFalse,schema\u003dinput_schema)\n\nFY_next \u003d FY_next.selectExpr(\u0027BBLE\u0027,\u0027B\u0027,\u0027BLOCK\u0027,\u0027LOT\u0027,\u0027FULLVAL AS FULLVAL_NEXT\u0027,\u0027OWNER AS OWNER_NEXT\u0027,\u0027BLDGCL\u0027,\u0027TAXCLASS AS TAXCLASS_NEXT\u0027,\u0027STORIES AS STORIES_NEXT\u0027,\u0027STADDR\u0027,\u0027ZIP\u0027,\u0027EXMPTCL AS EXMPTCL_NEXT\u0027,\u0027YEAR\u0027)\n\nFY_next \u003d FY_next.where(~ (FY_next[\u0027BLDGCL\u0027].like(\"Z%\" ) | FY_next[\u0027BLDGCL\u0027].like(\"Y%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"E%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"F%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"G%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"I%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"J%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"M%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"N%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"P%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"Q%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"T%\" ) ) )\nFY_curr \u003d FY_curr.where(~ (FY_curr[\u0027BLDGCL\u0027].like(\"U%\" ) | FY_curr[\u0027BLDGCL\u0027].like(\"W%\" ) ) )\n\nFY_next \u003d FY_next.filter(FY_next.FULLVAL_NEXT !\u003d 0.0)\n\nFY_next \u003d FY_next.filter(FY_next.B \u003d\u003d 3)\n\nFY_next \u003d FY_next.selectExpr(\u0027BBLE\u0027,\u0027FULLVAL_NEXT\u0027,\u0027OWNER_NEXT\u0027, \u0027BLDGCL AS BLDGCL_NEXT\u0027, \u0027TAXCLASS_NEXT\u0027)\n\nFY_next.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+------------+--------------------+-----------+-------------+\n|      BBLE|FULLVAL_NEXT|          OWNER_NEXT|BLDGCL_NEXT|TAXCLASS_NEXT|\n+----------+------------+--------------------+-----------+-------------+\n|3000010001|   2506000.0|BROOKLYN BRIDGE PARK|         V1|            4|\n|3000010050|    3.0624E7|SAFDI PLAZA PROPERTY|         O6|            4|\n|3000011001|    834878.0|1 JOHN STREET COM...|         RK|            4|\n|3000011002|    546122.0|BROOKLYN BRIDGE PARK|         RK|            4|\n|3000011003|    665078.0|AIMEE CARROLL AS ...|         R4|            2|\n|3000011004|    640547.0|       FREIMAN, ALAN|         R4|            2|\n|3000011005|    378876.0|    MAYER, JEFFREY S|         R4|            2|\n|3000011006|    613290.0|    CURTIS, COLTRANE|         R4|            2|\n|3000011007|    665078.0|  CARLIN, ALESSANDRA|         R4|            2|\n|3000011008|    640547.0|           1J3B, LLC|         R4|            2|\n+----------+------------+--------------------+-----------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525567532636_-1832666242",
      "id": "20180505-204532_1032996535",
      "dateCreated": "May 5, 2018 8:45:32 PM",
      "dateStarted": "May 6, 2018 6:48:07 PM",
      "dateFinished": "May 6, 2018 6:48:20 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY_curr \u003d FY_curr.join(FY_next, \"BBLE\", how\u003d\u0027inner\u0027)\n\nFY_curr.show(n\u003d 10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:47:59 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|community_district_definition|FULLVAL_NEXT|          OWNER_NEXT|BLDGCL_NEXT|TAXCLASS_NEXT|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|         Brooklyn Heights ...|   1555000.0|           NYC PARKS|         Q1|            4|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|         Brooklyn Heights ...|   2801000.0|     SCHERZER HOWARD|         B3|            1|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|         Brooklyn Heights ...|   1316000.0|                LILY|         C3|           2A|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1624000.0|   NORMAN A BENJAMIN|         S5|           2A|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1087000.0|         LEVITT BERT|         S2|            1|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1087000.0|416 ATLANTIC AVEN...|         S2|            1|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|         Brooklyn Heights ...|   3727000.0|    KELLEY, PATRICIA|         B1|            1|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|         Brooklyn Heights ...|    234000.0|THE TEMPLE OF RES...|         V1|            4|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|         Brooklyn Heights ...|   7847000.0|WILLOW ST. BROOKLYN,|         B1|            1|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|         Brooklyn Heights ...|   4064000.0|    150 HICKS STREET|         C1|           2B|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525568427510_1944129129",
      "id": "20180505-210027_829558836",
      "dateCreated": "May 5, 2018 9:00:27 PM",
      "dateStarted": "May 6, 2018 6:48:17 PM",
      "dateFinished": "May 6, 2018 6:48:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndef attr_change(attr1, attr2):\n    if attr1 \u003d\u003d attr2:\n        return 0\n    else:\n        return 1\n\nattr_udf \u003d udf(attr_change, IntegerType())\n\nFY_curr \u003d FY_curr.withColumn(\"OWN_change\", attr_udf(FY_curr[\u0027OWNER\u0027], FY_curr[\u0027OWNER_NEXT\u0027])) \n\nFY_curr \u003d FY_curr.withColumn(\"BLDGCL_change\", attr_udf(FY_curr[\u0027BLDGCL\u0027], FY_curr[\u0027BLDGCL_NEXT\u0027])) \n\nFY_curr \u003d FY_curr.withColumn(\"TXCL_change\", attr_udf(FY_curr[\u0027TAXCLASS\u0027], FY_curr[\u0027TAXCLASS_NEXT\u0027])) \n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:00 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+----------+-------------+-----------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|community_district_definition|FULLVAL_NEXT|          OWNER_NEXT|BLDGCL_NEXT|TAXCLASS_NEXT|OWN_change|BLDGCL_change|TXCL_change|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+----------+-------------+-----------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|         Brooklyn Heights ...|   1555000.0|           NYC PARKS|         Q1|            4|         1|            1|          0|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|         Brooklyn Heights ...|   2801000.0|     SCHERZER HOWARD|         B3|            1|         0|            0|          0|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|         Brooklyn Heights ...|   1316000.0|                LILY|         C3|           2A|         0|            0|          0|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1624000.0|   NORMAN A BENJAMIN|         S5|           2A|         0|            0|          0|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1087000.0|         LEVITT BERT|         S2|            1|         0|            0|          0|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|         Brooklyn Heights ...|   1087000.0|416 ATLANTIC AVEN...|         S2|            1|         0|            0|          0|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|         Brooklyn Heights ...|   3727000.0|    KELLEY, PATRICIA|         B1|            1|         0|            0|          0|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|         Brooklyn Heights ...|    234000.0|THE TEMPLE OF RES...|         V1|            4|         0|            0|          0|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|         Brooklyn Heights ...|   7847000.0|WILLOW ST. BROOKLYN,|         B1|            1|         0|            0|          0|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|         Brooklyn Heights ...|   4064000.0|    150 HICKS STREET|         C1|           2B|         0|            0|          0|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+-----------------------------+------------+--------------------+-----------+-------------+----------+-------------+-----------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525569440291_1172086689",
      "id": "20180505-211720_351142870",
      "dateCreated": "May 5, 2018 9:17:20 PM",
      "dateStarted": "May 6, 2018 6:48:20 PM",
      "dateFinished": "May 6, 2018 6:48:38 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nFY_curr \u003d FY_curr.drop(\u0027OWNER_NEXT\u0027,\u0027BLDGCL_NEXT\u0027,\u0027TAXCLASS_NEXT\u0027,\u0027community_district_definition\u0027)\n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:00 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|FULLVAL_NEXT|OWN_change|BLDGCL_change|TXCL_change|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|   1555000.0|         1|            1|          0|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|   2801000.0|         0|            0|          0|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|   1316000.0|         0|            0|          0|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|   1624000.0|         0|            0|          0|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|   3727000.0|         0|            0|          0|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|    234000.0|         0|            0|          0|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|   7847000.0|         0|            0|          0|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|   4064000.0|         0|            0|          0|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525569884142_-690085952",
      "id": "20180505-212444_1796812233",
      "dateCreated": "May 5, 2018 9:24:44 PM",
      "dateStarted": "May 6, 2018 6:48:30 PM",
      "dateFinished": "May 6, 2018 6:48:45 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\necon_soc_data \u003d spark.read.csv(\"/user/nycDevPlan_PBD18/data/FY18_20_soc_econ_change.csv\",header\u003dTrue)\n\necon_soc_data.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:38 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\n|DIST_NUM|      UNEMPL_change|        TRVL_change|       HINC_change|       CINC_change|        HINS_change|HOUSEH_SZ|          HH_change|       BACH_change|      DIFFH_change|        FORB_change|        NCIT_change|        LANG_change|        AGE_change|MTG_RT_change|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\n|     301|-13.888888888888884| 2.4316109422492533|13.668364718676665|12.662306587972564|-22.592648463820588|     2.44| 1.2295081967213217| 5.949656750572087|  3.84615384615385|-1.2552301255230138|  2.529182879377434| -4.174228675136119| 0.317460317460322|        10.98|\n|     302|-15.957446808510637|-0.2840909090909131| 7.117516629711752| 8.119060644742975|-18.999451109542854|      2.2| 0.4545454545454448|2.9209621993127177| 6.250000000000005|   2.03045685279188|-2.4667931688804576|   0.34965034965035|  2.06489675516225|        10.98|\n|     303| -14.66666666666666| 1.4742014742014602| 8.870924423913626|11.461042088028508| -18.83124556842354|     2.74|                0.0|17.928286852589633| 4.587155963302757|-1.5075376884422125|  5.118110236220478|  2.572347266881031|-0.647249190938509|        10.98|\n|     304|-10.563380281690131| 2.2784810126582244| 7.475421527176404| 16.21051462832399|-17.407655753476575|     3.06| -3.921568627450984| 20.20202020202019|11.403508771929822|-3.8888888888888924| 11.949685534591188| -5.669291338582682|1.3333333333333286|        10.98|\n|     305| -17.88617886178861|  4.566210045662101| 6.538416490981494| 9.865747013178963|-18.244752121482804|     2.91|-0.6872852233676982| 8.955223880597002|4.8387096774193585|  3.757225433526015| 0.8896797153024721| 3.7647058823529442|2.4767801857585274|        10.98|\n|     306| -13.23529411764707| 0.2666666666666705| 8.856019472008986|  9.69273883640147| -33.70409435228689|     2.32| 0.8620689655172422| 4.572271386430666|7.2368421052631655|-1.7341040462427602|-1.4056224899598406|-6.9090909090909145|1.1331444759206961|        10.98|\n|     307|-22.222222222222225|-1.8475750577367143| 8.826714801444044| 9.031566640685892|-14.470301492437649|      3.2| 1.5624999999999944| 6.504065040650413|               0.0|-0.6237006237006243|  5.539358600583079| -1.200000000000001|1.5243902439024393|        10.98|\n|     308| -24.56140350877194| 0.7246376811594306| 8.013862843307143|11.744230041619371|-15.810758406736468|     2.38|                0.0| 9.169054441260755| 9.278350515463911| -5.448717948717953|   5.15653775322282|-0.9174311926605512|0.8849557522124021|        10.98|\n|     309|-28.205128205128204|-0.9389671361502313| 5.850187444781394|11.815521805768427| -17.51893346685861|     2.67|-1.4981273408239715| 12.06225680933851|2.4390243902439046|  -1.90930787589499|  5.614035087719304|  6.228373702422151|0.5865102639296063|        10.98|\n|     310| -11.36363636363636| 2.1126760563380245|  7.80989832429943| 5.685940861078113|-15.864356800589752|     2.61|-1.5325670498084305| 7.065217391304354| 16.86746987951807|  2.343750000000002| 0.6956521739130441|   1.80505415162453|1.8087855297157511|        10.98|\n+--------+-------------------+-------------------+------------------+------------------+-------------------+---------+-------------------+------------------+------------------+-------------------+-------------------+-------------------+------------------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525640274571_459065881",
      "id": "20180506-165754_862668905",
      "dateCreated": "May 6, 2018 4:57:54 PM",
      "dateStarted": "May 6, 2018 6:48:38 PM",
      "dateFinished": "May 6, 2018 6:48:45 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY_curr \u003d FY_curr.join(econ_soc_data, FY_curr.community_district \u003d\u003d econ_soc_data.DIST_NUM, how\u003d\u0027inner\u0027)\n\nFY_curr \u003d FY_curr.drop(\"DIST_NUM\")\n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:45 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|FULLVAL_NEXT|OWN_change|BLDGCL_change|TXCL_change|      UNEMPL_change|        TRVL_change|      HINC_change|      CINC_change|        HINS_change|HOUSEH_SZ|         HH_change|       BACH_change|     DIFFH_change|     FORB_change|        NCIT_change|     LANG_change|      AGE_change|MTG_RT_change|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|   1555000.0|         1|            1|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|   2801000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|   1316000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|   1624000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|   3727000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|    234000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|   7847000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|   4064000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525640415125_924966674",
      "id": "20180506-170015_1148819377",
      "dateCreated": "May 6, 2018 5:00:15 PM",
      "dateStarted": "May 6, 2018 6:48:45 PM",
      "dateFinished": "May 6, 2018 6:48:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndef per_change(attr1, attr2):\n    change \u003d  attr2 - attr1\n    return change / attr1 * 100\n\nper_udf \u003d udf(per_change, DoubleType())\nFY_curr \u003d FY_curr.withColumn(\"VAL_%_change\", per_udf(FY_curr[\u0027FULLVAL_CURR\u0027], FY_curr[\u0027FULLVAL_NEXT\u0027])) \n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:00 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+-------------------+\n|      BBLE|  B|BLOCK|LOT|FULLVAL_CURR|               OWNER|BLDGCL|TAXCLASS|STORIES|             STADDR|  ZIP|EXMPTCL|community_district|FULLVAL_NEXT|OWN_change|BLDGCL_change|TXCL_change|      UNEMPL_change|        TRVL_change|      HINC_change|      CINC_change|        HINS_change|HOUSEH_SZ|         HH_change|       BACH_change|     DIFFH_change|     FORB_change|        NCIT_change|     LANG_change|      AGE_change|MTG_RT_change|       VAL_%_change|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+-------------------+\n|3000070001|  3|    7|  1|   1509200.0|DEPT OF ENVIRONME...|    V1|       4|   null|111 PLYMOUTH STREET|11201|     X1|               302|   1555000.0|         1|            1|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98| 3.0347203816591573|\n|3001730053|  3|  173| 53|   2626000.0|     SCHERZER HOWARD|    B3|       1|      3|   435 STATE STREET|11217|   null|               302|   2801000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  6.664127951256664|\n|3001760046|  3|  176| 46|   1058000.0|                LILY|    C3|      2A|      4|315 ATLANTIC AVENUE|11201|   null|               302|   1316000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  24.38563327032136|\n|3001770046|  3|  177| 46|   1287000.0|   NORMAN A BENJAMIN|    S5|      2A|      4|375 ATLANTIC AVENUE|11217|   null|               302|   1624000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98| 26.184926184926184|\n|3001830024|  3|  183| 24|    845000.0|         LEVITT BERT|    S2|       1|      3|380 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  28.63905325443787|\n|3001840007|  3|  184|  7|    845000.0|416 ATLANTIC AVEN...|    S2|       1|      3|416 ATLANTIC AVENUE|11217|   null|               302|   1087000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  28.63905325443787|\n|3001840042|  3|  184| 42|   3505000.0|    KELLEY, PATRICIA|    B1|       1|      3| 433 PACIFIC STREET|11217|   null|               302|   3727000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  6.333808844507846|\n|3001910037|  3|  191| 37|    272000.0|THE TEMPLE OF RES...|    V1|       4|   null|        76 3 AVENUE|11217|     X5|               302|    234000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|-13.970588235294118|\n|3002340046|  3|  234| 46|   6849000.0|WILLOW ST. BROOKLYN,|    B1|       1|      3|  104 WILLOW STREET|11201|   null|               302|   7847000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  14.57147028763323|\n|3002350056|  3|  235| 56|   2855000.0|    150 HICKS STREET|    C1|      2B|      5|   150 HICKS STREET|11201|   null|               302|   4064000.0|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|  42.34676007005254|\n+----------+---+-----+---+------------+--------------------+------+--------+-------+-------------------+-----+-------+------------------+------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+-------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525568739660_-1837337948",
      "id": "20180505-210539_1826847185",
      "dateCreated": "May 5, 2018 9:05:39 PM",
      "dateStarted": "May 6, 2018 6:48:45 PM",
      "dateFinished": "May 6, 2018 6:49:04 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\ndef find_category(percent_change):\n    if percent_change \u003e 20:\n        return 1\n    elif percent_change \u003e 5:\n        return 2\n    elif percent_change \u003e -5:\n        return 3\n    elif percent_change \u003e -20:\n        return 4\n    else:\n        return 5\n        \n#find_cat_udf \u003d udf(find_category, IntegerType())\n#FY_curr \u003d FY_curr.withColumn(\"result\",find_cat_udf(FY_curr[\u0027VAL_%_change\u0027]))\n\n#FY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:56 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1525639876971_-8603247",
      "id": "20180506-165116_395341995",
      "dateCreated": "May 6, 2018 4:51:16 PM",
      "dateStarted": "May 6, 2018 6:48:56 PM",
      "dateFinished": "May 6, 2018 6:49:04 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY_curr \u003d FY_curr.drop(\"FULLVAL_NEXT\", \"OWNER\", \"B\",\"LOT\", \"STADDR\", \"VAL_%_change\")\n\nFY_curr.show(n\u003d10)",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:49:04 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+-----+------------+------+--------+-------+-----+-------+------------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\n|      BBLE|BLOCK|FULLVAL_CURR|BLDGCL|TAXCLASS|STORIES|  ZIP|EXMPTCL|community_district|OWN_change|BLDGCL_change|TXCL_change|      UNEMPL_change|        TRVL_change|      HINC_change|      CINC_change|        HINS_change|HOUSEH_SZ|         HH_change|       BACH_change|     DIFFH_change|     FORB_change|        NCIT_change|     LANG_change|      AGE_change|MTG_RT_change|\n+----------+-----+------------+------+--------+-------+-----+-------+------------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\n|3000070001|    7|   1509200.0|    V1|       4|   null|11201|     X1|               302|         1|            1|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001730053|  173|   2626000.0|    B3|       1|      3|11217|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001760046|  176|   1058000.0|    C3|      2A|      4|11201|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001770046|  177|   1287000.0|    S5|      2A|      4|11217|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001830024|  183|    845000.0|    S2|       1|      3|11217|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001840007|  184|    845000.0|    S2|       1|      3|11217|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001840042|  184|   3505000.0|    B1|       1|      3|11217|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3001910037|  191|    272000.0|    V1|       4|   null|11217|     X5|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3002340046|  234|   6849000.0|    B1|       1|      3|11201|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n|3002350056|  235|   2855000.0|    C1|      2B|      5|11201|   null|               302|         0|            0|          0|-15.957446808510637|-0.2840909090909131|7.117516629711752|8.119060644742975|-18.999451109542854|      2.2|0.4545454545454448|2.9209621993127177|6.250000000000005|2.03045685279188|-2.4667931688804576|0.34965034965035|2.06489675516225|        10.98|\n+----------+-----+------------+------+--------+-------+-----+-------+------------------+----------+-------------+-----------+-------------------+-------------------+-----------------+-----------------+-------------------+---------+------------------+------------------+-----------------+----------------+-------------------+----------------+----------------+-------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1525639839248_-175076927",
      "id": "20180506-165039_1212949449",
      "dateCreated": "May 6, 2018 4:50:39 PM",
      "dateStarted": "May 6, 2018 6:49:04 PM",
      "dateFinished": "May 6, 2018 6:49:10 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nFY_curr.write.format(\"csv\").option(\"header\", \"true\").save(\"/user/nycDevPlan_PBD18/data/pred_set.csv\")",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:49:05 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1525640932654_841411577",
      "id": "20180506-170852_1492758458",
      "dateCreated": "May 6, 2018 5:08:52 PM",
      "dateStarted": "May 6, 2018 6:49:05 PM",
      "dateFinished": "May 6, 2018 6:49:50 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "May 6, 2018 6:48:00 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1525641673654_-1289105071",
      "id": "20180506-172113_1679796294",
      "dateCreated": "May 6, 2018 5:21:13 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "prepare_training_set",
  "id": "2DC6711MW",
  "angularObjects": {
    "2CFXK5J4Y:shared_process": [],
    "2CF295UYG:shared_process": [],
    "2CD6ZRPDJ:shared_process": [],
    "2CFG6Y8G3:shared_process": [],
    "2CFJKQVBN:shared_process": [],
    "2CGYXR37V:shared_process": [],
    "2CDY97F39:shared_process": [],
    "2CEC5KMFB:shared_process": [],
    "2CFFWS5P3:shared_process": [],
    "2CDM4T1EH:shared_process": [],
    "2CG949ZHZ:shared_process": [],
    "2CEJ86HV3:shared_process": [],
    "2CFGNABPQ:shared_process": [],
    "2CEZV3CHG:shared_process": [],
    "2CDUTWP3P:shared_process": [],
    "2CFXDXWCE:shared_process": [],
    "2CEZMWG72:shared_process": [],
    "2CFWFHNZR:shared_process": [],
    "2CG23YGEZ:shared_process": []
  },
  "config": {},
  "info": {}
}